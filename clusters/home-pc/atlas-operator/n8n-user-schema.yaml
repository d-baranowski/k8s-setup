apiVersion: db.atlasgo.io/v1alpha1
kind: AtlasSchema
metadata:
  name: n8n-user
  namespace: atlas-operator
spec:
  urlFrom:
    secretKeyRef:
      name: atlas-db-url
      namespace: atlas-operator
      key: value
  vars:
    - key: n8n_password
      valueFrom:
        secretKeyRef:
          name: n8n-user-password
          namespace: atlas-operator
          key: password
  schema:
    sql: |
      CREATE ROLE n8n_user WITH LOGIN PASSWORD '{{ .n8n_password }}';
      CREATE DATABASE n8n;
      GRANT ALL PRIVILEGES ON DATABASE n8n TO n8n_user;
